@using PlanningGambler.Front.Pages.Dialogs
@inherits LayoutComponentBase
@inject IMatDialogService MatDialogService

<div class="page">
    <main>
        <MatFAB style="position: fixed; right: 50px; bottom: 50px; z-index: 2;" OnClick="@ChangeMenuState" RefBack="_buttonForwardRef" Icon="@GetButtonIcon()"></MatFAB>
        <MatMenu @ref="_menu" TargetForwardRef="@_buttonForwardRef">
            <MatList>
                <MatListItem OnClick="@(_ => JoinRoom())">Join</MatListItem>
                <MatListItem OnClick="@(_ => CreateRoom())">Create</MatListItem>
                <MatListItem OnClick="@(_ => CloseMenu())" style="color: red">Close</MatListItem>
            </MatList>
        </MatMenu>
        <article class="content px-4">
            @Body
        </article>
    </main>
</div>

@code
{
    readonly ForwardRef _buttonForwardRef = new();
    MatMenu? _menu;

    public async Task CreateRoom()
    {
        await MatDialogService.OpenAsync(typeof(CreateRoomDialog), null);
    }

    public async Task JoinRoom()
    {
        await MatDialogService.OpenAsync(typeof(JoinRoomDialog), null);
    }

    private string GetButtonIcon()
    {
        return MatIconNames.Menu;
    }

    private async Task ChangeMenuState()
    {
        await _menu!.OpenAsync();
    }

    private async Task CloseMenu()
    {
        await _menu!.CloseAsync();
    }
}